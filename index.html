<script type="module">
  import { createClient } from 'https://esm.sh/@supabase/supabase-js'

  const supabase = createClient(
    'https://iwnnwqbtmpeqhdysoewk.supabase.co',
    'eyJhbGciOiJI...Dzw' // TwÃ³j anonKey
  );

  // ğŸ” Zainicjuj sesjÄ™ z URL (access_token)
  const { error: sessionError } = await supabase.auth.getSessionFromUrl();
  if (sessionError) {
    document.getElementById('message').textContent =
      'BÅ‚Ä…d sesji: ' + sessionError.message;
  }

  document.getElementById('reset-form').addEventListener('submit', async (e) => {
    e.preventDefault();
    const password = document.getElementById('new-password').value;

    // ğŸ”„ Zaktualizuj hasÅ‚o
    const { error } = await supabase.auth.updateUser({ password });
    const msg = document.getElementById('message');

    if (error) {
      msg.textContent = 'BÅ‚Ä…d przy zmianie hasÅ‚a: ' + error.message;
      msg.style.color = 'red';
    } else {
      msg.textContent = 'HasÅ‚o zostaÅ‚o pomyÅ›lnie zmienione ğŸ‰';
      msg.style.color = 'green';
    }
  });
</script>
